<!DOCTYPE html>

<html>
  <head>
    <title>Ruby Workshop - Roberto Soares - SINFORM 2013</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css" media="screen">
      @import url(http://fonts.googleapis.com/css?family=Ubuntu:400,500);
      @import url(http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);

      body { 
        font-family: 'Ubuntu';
        font-weight: 400;
      }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: 400;
        margin: 5px;
      }
      h1 { font-size: 4em; }
      h2 { font-size: 2.3em; }
      h3 { font-size: 1.6em; }
      body { font-size: 1.5em; }

      .slide .content {
        padding: 10px 90px !important;
      }

      #slideshow .no-highlight {
        font-size: 1em !important;
      }

      blockquote {
        font-style: italic;
        margin: 0.25em 0;
        padding: 0.25em 40px;
        line-height: 1.45;
        position: relative;
      }

      blockquote:before {
        opacity: 0.8;
        display: block;
        content: "\201C";
        font-size: 3em;
        position: absolute;
        left: -20px;
        top: -20px;
      }

      blockquote cite {
        opacity: 0.8;
        font-size: 1em;
        display: block;
        margin-top: 5px;
      }
 
      blockquote cite:before {
        content: "\2014 \2009";
      }

     /* Two-column layout */
    .left-column {
      width: 50%;
      float: left;
    }
    .right-column {
      width: 50%;
      float: right;
    }

    code {
      -moz-border-radius: 5px;
      -web-border-radius: 5px;
      background: #e7e8e2;
      border-radius: 5px;
    }

    .inverse {
      background: #A60A17;
    }

    /* slides */

    .bg-red {
      background: #A60A17;
    }
    .bg-dark {
      color: white;
      text-shadow: 0 0 20px #333;
    }
    .bg-matz {
      background-image:url(images/matz.jpg);
    }

    </style>
  </head>
  <body>
    <textarea id="source">

name: inverse
class: center, middle, bg-red, bg-dark
layout: true
---
# #ruby
---
layout: false

## Sobre mim

* Hi, I'm Roberto
* Formado pela UESC
--

* Trabalho com Ruby desde 2006
--

* Techmobil
--
 \o/
--

* Bopia
* Todobebe
* e-Core

--
* Globo.com
---
template: inverse
# Ruby: Produzindo e se Divertindo
---
## Agenda
* Ruby
* Jogo
* Ranking
---
template: inverse

## Preparando o Ambiente

---

## Ambiente

### Verificando a instalação

``` bash
$ which ruby
/usr/bin/ruby
$ ruby -v
ruby 1.9.3p448 (2013-06-27 revision 41675) [x86_64-darwin12.3.0]
```

[http://www.ruby-lang.org/en/downloads/](http://www.ruby-lang.org/en/downloads/)

--

### Pequenos exemplos: Interactive Ruby (irb)
``` bash
$ irb
(irb)> print 'Hello World!'
# Hello World!
```

---
## Ambiente

### Exemplos Maiores: Arquivos

Qualquer editor com syntax highlighting  
Gedit, SublimeText, SciTE, Scribes, Emacs, Vim

--

``` bash
$ ruby hello.rb
# Hello World!
```
--

``` bash
(irb)> load 'hello.rb'
# Hello World!
```
---
template: inverse
senta que lá vem
## História
---
template: inverse
class: bg-matz, bg-dark
### Yukihiro Matsumoto a.k.a. Matz  
--

## Matz + Perl + Python + Smalltalk + Lisp = Ruby
--

<blockquote>Eu queria uma linguagem mais poderosa que o **Perl** e mais orientada a objeto que **Python**</blockquote>

--

## 1993 - 1995 -> Ruby 0.95  
## 2000 - primeiro livro em inglês
## 2004 - Rails
---
template: inverse
# Pq?
---
name: pq
## Por que aprender Ruby?
--

### Fácil de ler
```
5.times { print 'Ê' } if Date.today.friday?
# ÊÊÊÊÊ
```
```
exit unless "restaurante".start_with? "rest"
```
--

### Fácil de aprender   

<blockquote>Aprendi Ruby mais rápido do que qualquer outra linguagem, de um total de 30 ou 40; levei 3 dias para ficar mais confortável com Ruby do que com Perl, após 8 anos de Perl hacking.<cite>Steve Yegge</cite></blockquote>
---
template: pq

### Multi-paradigma
* OO (Java, Smalltalk)  
* Funcional (Haskell)  
* Imperativa (Forth, Ada)

--

### Comunidade  

* Github - 2º
* [RubyGems.org](http://rubygems.org/) - 62.730 gems, 2.052.497.597 downloads  
* [Module Counts](http://www.modulecounts.com/)
* Conferências! (RubyConfBR - SP, Rock'n Rails - ES)  

---
template: pq
name: who
### Quem usa? (Mercado!)  
--

* Funny or Die
* Github
* ThoughtWorks
* Yellow Pages
* Globo
* Hulu
* Groupon
* Techmobil
* Twitter
* e-Core
* EA
* Eu!
---
template: who
* Amazon
* BBC
* Cisco
* IBM
* NASA
* Oracle
* Siemens
* Yahoo!
* New York Times
* Google
* Chicago Tribune
* NBC
* Globo.com
---
template: inverse

## O que que é Ruby?

---
## Linguagem
--
 Interpretada
--
(MRI)
--
 e Compilada
--

### - [Rubinius](http://rubini.us/) -> [RubySpec](http://rubyspec.org/)
### - [JRuby](http://www.jruby.org/)
--

### - [mruby](https://github.com/mruby/mruby)
--

### - IronRuby
### - MacRuby
### - Cardinal

---
## De graça!

### MRI - GPL e Ruby open source license
### JRuby - GPL e LGPL
### Rubinius - BSD
---

## Tudo é objeto
--

### Tipos básicos
### Métodos
### até classes!

---
template: inverse
## Let's code!
---
name: mapa

* [Variáveis](#variaveis)
* [Constante](#constantes)
* [Tipos de Variáveis](#tipos_variaveis)
* [Métodos](#metodos)
* [Números](#numeros)
* [String](#string)
* [Symbol](#symbol)
* [nil](#nil)
* [Array](#array)
* [Range](#range)
* [Hash](#hash)
* [Fluxo](#fluxo)
* [if](#if)
* [unless](#unless)
* [case](#case)
* [loop](#loop)
* [while](#while)
---
name: mapa2

* [until](#until)
* [for](#for)
* [Blocos](#blocos)
* [Proc](#proc)
* [Métodos](#metodos)
* [DSL](#dsl)
* [Classes](#classe)
* [Herança](#heranca)
* [Modules](#module)
* [require](#require)

---
template: inverse
## Variáveis, constantes e métodos

---
name: variaveis

## Variáveis

Referências para seus dados.  
A atribuição é realizada com `=`.
```
nome = "Fulano da Silva"
_posição_no_ranking = 7
```
--

O primeiro caracter não deve ser maiúsculo.
```
valor1 = 1233
valor2 = 5793
```
--

```
total = valor1 + valor2
```
---
name: constantes

## Constantes
```
(irb)> Nome = "John"
(irb)> Nome = "João"
# warning: already initialized constant Nome
```
--

```
(irb)> Nome == "João"
# true
```
--

```
PI = 3.141592653589793
MINHA_CONSTANTE = "test"
(irb)> TRUE
# true
```
---
name: metodos

## Métodos

Um pedaço de código para executar uma tarefa.

```
print
print()
print "Hello World!"
print("Hello World!")
print("Hello", " ", "World", "!")
```
--

```
puts "Nome:"
puts "Olá #{gets}!"
```
```
puts "Nome:"
nome = gets
puts "Olá #{nome}!"
```
---
name: numeros

## Números
```
(irb)> 5 + 2 ** 2     # 9
(irb)> 10 - 4 / - 2   # 12
(irb)> (10 - 4) / - 2 # -3
(irb)> 35 % 6         # 5
```
--

```
(irb)> 1.34 + 0.123   # 1.463
```
--

```
(irb)> 1_747_182.34   # 1747182.34
```
--

```
(irb)> 3 > 5          # false
(irb)> 10 <=> 20      # - 1
(irb)> 1 == 1         # true
(irb)> 1 != 1         # false
```
---
## Números  
```
(irb)> 0.zero?        # serious?
(irb)> 2.even?        # true
(irb)> 0.odd?         # false
(irb)> 12123.to_s     # "12123"
(irb)> (1+2).next.next # 5
```
--

```
(irb)> 1.class        # Fixnum
(irb)> 0.1.class      # Float
```
--

```
(irb)> 1_000_000_000_000_000_000_000.class # Bignum
```

---
name: string

## String  
```
"Hello World!"
'Olá Mundo!'
```
--

```
(irb)> "O resultado é #{5 ** 2}"
"O resultado é 25"
```
--

```
"Oi \"Mundo\"!"
```
--

```
(irb)> "O resultado é \#{5 ** 2}"
# "O resultado é \#{5 ** 2}" 
```
--

```
(irb)> "Olá " + "Mundo"
# "Olá Mundo"
```

--

```
(irb)> '1' * 5
# 11111
(irb)> 'Ê!' * 5
# Ê!Ê!Ê!Ê!Ê!
```
---
## String  
```
(irb)> "casa".include? "asa"  # true
(irb)> "casa".length          # 4
(irb)> "casa".gsub("a","A")   # "cAsA"
(irb)> "  casa  ".rstrip      # "  casa"
(irb)> "casa".count("a")      # 2
```
--

```
(irb)> "2".to_i               # 2
(irb)> "2".to_f               # 2.0
(irb)> "2".rjust(5,"0")       # 00002
```
---
name: symbol

## Symbol
```
:casa

{{content}}
```
--
:"minha casa"
:"1"
--

### Único   
```
(irb)> Symbol.all_symbols.size # 2626
(irb)> :casa
(irb)> Symbol.all_symbols.size # 2627
```
--

### Imutável
```
(irb)> :casa.capitalize
(irb)> Symbol.all_symbols.size # 2628
```
---
## Symbol
### Mais rápido

```
require 'benchmark'
Benchmark.measure{ 10_000_000.times { :test } }.total             # 0.64
Benchmark.measure{ 10_000_000.times { "test" } }.total            # 1.62

Benchmark.measure{ 10_000_000.times { :test == :test } }.total    # 1.01
Benchmark.measure{ 10_000_000.times { "test" == "test" } }.total  # 3.18
```
--

### Possui poucos métodos

```
(irb)> String.instance_methods.size - Symbol.instance_methods.size # 83
(irb)> :casa.size     # 4
(irb)> :casa.empty?   # false
(irb)> :casa.to_s     # casa

```
---
name: nil

## nil

### vazio, vácuo, nada!
--

```
(irb)> carro = nil
(irb)> carro.acelera!
# NoMethodError: undefined method `acelera!' for nil:NilClass
{{content}}
```
--
(irb)> carro.class
# NilClass
--

## true/false

```
true != false     # true
false.to_s        # "false" ‘nuf said…
true.class        # TrueClass
```
---
name: array

## Array  
```
coisas = [1,"oi", 33, :test]
```
--

```
print coisas[0]
# 1
{{content}}
```
--
coisas.at(2)
coisas.fetch(10, "Não encontrado!")
coisas[-3]
coisas.values_at(1,3)
{{content}}
--

coisas << "qualquer coisa"
coisas.insert(-1,3)
coisas.push 7
{{content}}
--

coisas + ["abc"]
coisas * 2
coisas.join(", ")
{{content}}
--

coisas.pop
coisas.shift
coisas.delete_at 4
coisas.delete 4
{{content}}
---
## Array   
```
%w(casa elefante maçã)
# ["casa", "elefante", "maçã"]
Array.new(3,2)
# [2,2,2]
```
---
name: range

## Range
```
0..10
{{content}}
```
--
Range.new(2,5) # 2..5
--

```
(0...10).include? 10
# false
```
--

```
(50...10_012_821.84) === 8192912
# true
```
--

```
(1..1_000_000_000).to_a.reverse
```
--

```
Date.today..Date.today.next_year
"A".."Z"
```
--

```
(-1..10).class
# Range
```
---
name: hash

## Hash
```
paginas = {home: "index.html", about: "page2.html"}
{{content}}
```
--
paginas[:home]  # "index.html"
paginas["home"] # nil
--

```
# Ruby 1.8.*
paginas = {:home => "index.html", :about => "page2.html"}
```
--

```
coisas = {:oi => "Hello!", "um" => 1, 1.2 => Float, abc: %w(a b c)}

{{content}}
```
--
coisas[1.2]       # Float
coisas[:abc][1]   # "b"
--

```
mais_simples = {a: 1, b: 2}

{{content}}
```
--
mais_simples.values   # [1,2]
mais_simples.keys     # [:a, :b]
mais_simples.to_a     # [[:a, 1], [:b, 2]]

{{content}}
--
mais_simples[:c] = 3
---
## Hash  
```
options = {color: "green", width: 20}
config  = {database: "mysql"}
```
--

```
display_title("Livro 2", options)
```
--

```
default = {color: "blue", height: 30}
default.merge(options)  # {:color=>"green", :height=>30, :width=>20}
```
--

```
h = Hash.new("vazio...")
h[:a] = 1
print h[:a]   # 1
print h[:b]   # vazio...
```
---
template: inverse

## Controle de fluxo

---
name: fluxo

## Fluxo
```
print '1'
print '2'
print '3'
```
--

### linha após linha
--

### E se eu desejar só imprimir '2' se hoje for terça?
### E se eu desejar imprimir '3' até o mar virar sertão?
---
template: inverse

## Controle de fluxo
## 1. Condicionais

---
name: if

## if / else / elsif
```
resultado = "não acertou"
if gets.to_i == 3
  resultado = "acertou"
end
puts resultado
```
--

```
resultado = "não acertou"
resultado = "acertou" if gets.to_i == 3
puts resultado
```
--

```
if gets.to_i == 3
  puts "acertou"
else
  puts "não acertou"
end
```
--

```
puts gets.to_i == 3 ? "acertou" : "não acertou"
```
--

```
if gets.to_i == 3 then puts "acertou" else puts "nao acertou" end
```
---
## if / else / elsif

```
entrada = gets.to_i
if entrada == 3
  puts "acertou"
elsif [2,4].include? entrada
  puts "quase acertou"
else
  puts "não acertou"
end
```
--

```
if nil
  print "nil"
elsif false
  print "false"
elsif ""
  print "vazio"
elsif 0
  print "zero"
else
  print "nada"
end
```
--

```
# warning: string literal in condition
# vazio
```
---
name: unless

## unless

```
print 'Hello!' unless Time.now.year > 2013
```
--

```
print 'Hello!' if not Time.now.year > 2013
```
--

```
unless Time.now.year > 2013
  print "Hello!"
else
  print "Good bye!"
end
```

---
name: case

## case
```
valor = rand(10) + 1
case valor
  when 1      then "UHH!"
  when 2,3    then "uhh!"
  when 4,5,6  then "na média"
  when 7,8    then "passou"
  when 9,10   then "CDF"
end
```
--

```
valor = rand(10) + 1
case valor
  when 1
    "UHH!"
  when 2,3
    "uhh!"
  when 4,5,6
    "na média"
  when 7,8
    "passou"
  when 9,10
    "CDF"
end
```
---
## case  
```
valor = ["jaca", "laranja"][rand(2)]
print case valor
  when "jaca"
    "1 real"
  when "laranja"
    "10 real"
end
```
--

```
ano = Time.now.year
case
  when ano > 2013
    print "Hello!"
  else
    print "Good bye!"
end
```
---
template: inverse

## Controle de fluxo
## 2. Loops
---
name: loop

## Loop
```
loop do
  puts '3' {{content}}
end
```
--

  break
--

```
mar = "agua"
loop {
  puts '3'
  mar.chop! # remove último caractere
  break if mar.empty?
}
```
---
name: while

## while

```
mar = "agua"
while(mar.size > 0) do
  puts '3'
  mar.chop!
end
```
--

```
mar = "agua"
begin
  puts '3'
  mar.chop!
end while(mar.size > 0)

```
---
name: until

## until

```
mar = "agua"
begin
  puts '3'
  mar.chop!
end until(mar.empty?)
```
--

```
mar = "agua"
until(mar.empty?) do
  puts '3'
  mar.chop!
end
```
---
name: for

## for
```
mar = "agua"
for gota in "agua".chars do
  puts gota
end
```
--

```
for letra in "A".."Z" do
  puts letra
end
```
--

```
for chave, valor in {a: 1, b: 2} do
  puts "#{chave} => #{valor}"
end
```
---
name: blocos
template: inverse
## Blocos e Procs
---

## Blocos
--

```
mar = "agua"
for gota in mar.chars do
  puts gota
end
```
--

```
mar.each_char do |gota|
  puts gota
end
```
--

```
10.times { print 'Ê' }

10.times do
  print 'Ê'
end

10.times {|i| puts i}
```
--

```
["Dr. Fulano", "Dr. Sicrano"]{{content}}
```
--
.all?{|pro| pro.start_with?("Dr.")}
#true
---
name: proc

## Proc

```
{{content}}Proc.new {|pro| pro.start_with?("Dr.")}
```
--
validacao = 
--

```
validacao.call
{{content}}
```
--
# NoMethodError: undefined method `start_with?' for nil:NilClass
--

```
validacao.call("Mestre Jackson") # false
```
--

```
Proc.new do |email, telefone|
  email.include?("@") && telefone.include?("73")
end
```
---

template: inverse
## Métodos
---
name: metodos

## Definindo métodos

```
def print_total(valor1, valor2)
  print valor1 + valor2
end
print_total(10,21)
```
--

```
print media(10,30)
```
--

```
def media(valor1, valor2)
  return (valor1 + valor2) / 2
end

def media(valor1, valor2)
  (valor1 + valor2) / 2 # retorna a última linha executada
end

print media(10, 30)
```
---
## Definindo métodos
Valor padrão para argumentos
```
def media(valor1, valor2 = 6)
# ...
def media(valor1 = 0, valor2 = 6)
# ...
(irb)> media()
# 3
```
---
## Definindo métodos
Infinitos argumentos
--

```
def configure_servidor(servidor, *computadores)
  computadores.each do |computador|
    computador.servidor = servidor
  end
end

configure_servidor(minha_maquina, computador1, computador2, computador3)
```
--

```
def media(*valores)
  valores.reduce(:+) / valores.size
end
```
---
## Métodos
### E os blocos?

```
def tudo_valido?(lista, &validador)
{{content}}
```
--
  lista.each do |elemento|
    return false unless validador.call(elemento)
  end
  return true
end

{{content}}
--
resultado1 = tudo_valido?(["Dr. Fulano", "Dr. Sicrano"]) do |pro|
  pro.start_with?("Dr.")
end
puts resultado1 # true

{{content}}
--
resultado2 = tudo_valido?(["Dr. Fulano", "Mestre Sicrano"]) do |pro|
  pro.start_with?("Dr.")
end
puts resultado2 # false

---
## Métodos
### E os blocos?

```
def tudo_valido?(lista)
  lista.each do |elemento|
    return false unless yield(elemento)
  end
  return true
end
```
--

```
block_given?
```
--

```
def tudo_valido?(lista)
  return true if lista.empty? || !block.given?
  lista.each do |elemento|
    return false unless yield(elemento)
  end
  return true
end
```
---
name: dsl

## DSL - Domain-Specific Language
```
descreva Casa do
  ela "deveria ter uma porta" do
    casa.deveria ter(1).porta
  end
end
```
--

## RSpec

```
describe Casa do
  it "should have a door" do
    subject.should have(1).door
  end
end
```
---
## Métodos  
### Objetos?
```
minha_media = method(:media)
puts minha_media.call(1,2,3) # 2
```
--

```
minha_media.class # Method
```
---
template: inverse
## Classe
---
## Classe  
```
meu_tecoteco = Aviao.new("ID7-2")
outro_tecoteco = Aviao.new("BZ-1")
{{content}}
```
--

meu_tecoteco.acelera(20)
meu_tecoteco.acelera(90)
outro_tecoteco.acelera(90)

meu_tecoteco.decola!
outro_tecoteco.decola!

{{content}}
--

print Aviao.quantidade        # 2
print meu_tecoteco.voando?    # true se a velocidade > 100
print outro_tecoteco.voando?  # false
--

```
class Aviao
{{content}}
end
```
--
  def initialize(registro)
    @registro = registro
  end
---
name: tipos_variaveis

### meu_tecoteco: variável local
--

### @registro: variável de instância
--

### @@contador: variável de classe
--

### $torre: variável global
---
name: classe

## Classe: Avião
```
class Aviao
  @@contador = 0
  def initialize(registro)
    @registro = registro
    @velocidade = 0
    @@contador += 1
  end
{{content}}
end
```
--
  def self.quantidade # método de classe
    @@contador
  end
--

```
print Aviao.quantidade
```
---
## Classe: Aviao

```
class Aviao
  def initialize(registro)
    @registro = registro
    @velocidade = 0
    @@contador += 1
  end

  def self.quantidade # método de classe
    @@contador
  end

  def acelera(vel = 1)
    @velocidade += vel
  end
{{content}}
end
```
--
  def decola!
    @no_ar = true if vel > 100
  end
{{content}}
--
  def voando?
    @no_ar
  end
---
## Classe: Aviao

```
class Aviao
  @@contador = 0
  attr_accessor :registro, :velocidade, :no_ar

{{content}}
```
--
  def initialize(id)
    self.registro = id
    @velocidade = 0
    @@contador += 1
  end
{{content}}
--
  def self.quantidade; @@contador; end
  def acelera(vel = 1)
    @velocidade += vel
  end
  def decola!
    @no_ar = true if vel > 100
  end
  def voando?; 
    self.no_ar
  end
end

{{content}}
--
aviao = Aviao.new("test")
puts aviao.registro       # test
puts aviao.no_ar = true
puts aviao.voando?        # true
---
name: heranca

## Herança
--

### Classe Jato

* voa com velocidade maior que 200
* mesmo contador de Aviao

--

```
class Jato < Aviao
{{content}}
end

meu_jatinho = Jato.new("AZ-5")
meu_jatinho.acelera(150)
meu_jatinho.decola!
meu_jatinho.voando?
```
--
  def decola!
    @no_ar = true if vel > 200
  end
---
name: module

## Module
```
class Barco
  attr_accessor :velocidade
  # (...)
end
class Jato < Aviao
  attr_accessor :velocidade
  # (...)
end
```
--

### Nitro!
--

```
module Turbo
  def nitro!
    @velocidade += 200
  end
end
```
--

```
class Jato < Aviao
  include Turbo
end
class Barco
  include Turbo
end
```
---
name: require

## require
``` bash
projeto/lib/asteroid.rb
projeto/lib/spaceship.rb
```
--

``` bash
ruby -Ilib game.rb
```
```
require 'asteroide'
require 'spaceship'
```
--

``` bash
ruby -I. game.rb
```
```
require 'lib/asteroid'
require 'lib/spaceship'
```

--

``` bash
ruby game.rb
```
```
require_relative 'lib/asteroid'
require_relative 'lib/spaceship'
```

---
template: inverse

# AÊ!

---
## Aprenda mais

* Expressões Regulares
* Criação de gems
* Pratique!

---
## Referências  

### Livros  
[The Bastards Book of Ruby](http://ruby.bastardsbook.com/)  
[Programming Ruby](http://www.ruby-doc.org/docs/ProgrammingRuby/)  
[Mr. Neighborly's Humble Little Ruby Book](http://www.humblelittlerubybook.com/)

### Artigos  
[Tour de babel](https://sites.google.com/site/steveyegge2/tour-de-babel)  
[developerWorks interviews Matz](http://www.nt.ntnu.no/users/haugwarb/Programming/Ruby/ruby_features.html#h7)  
[The Difference Between Ruby Symbols and Strings](http://www.robertsosinski.com/2009/01/11/the-difference-between-ruby-symbols-and-strings/)

### Foto
[Matz with the Nice and Blave Community](http://www.flickr.com/photos/ncr/4655763428/)

---
## Gostou?
[@bt1](http://twitter.com/bt1)  

[Recomende-me no WWR!](http://www.workingwithrails.com/person/9376-roberto-soares)  

[http://blog.robertosoares.me/](http://blog.robertosoares.me/)

    </textarea>
    <div id="slideshow"></div>
 <script src="https://github.com/downloads/gnab/remark/remark-0.4.2.min.js" type="text/javascript">
      {"highlightStyle": "monokai",
       "highlightLanguage": "ruby" }
    </script>
  </body>
</html>
